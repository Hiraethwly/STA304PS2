---
title: "PS2"
author: "Yanlin Li"
date: "10/14/2020"
output: pdf_document
---

```{r}
library(readr)
gss <- read_csv("gss.csv")

```

```{r}
library(tidyverse)
library(ggplot2)
```


# Data selection

Response variable: feelings of life. 

Several parts of possible features:

1. Basic information: age, sex, region (make sure that the survey is evenly distributed between these categories, making the inference representative)

2. Family: marital_status, total_children

3. Living condition: own_rent, living_arrangement, hh_type, hh_size

4. Health: self_rated_health, self_rated_mental_health

5. religon: regilion_importance

6. Knowledge and education: language_knowledge, education

7. Financial status: income_family, income_respondent

```{r}
data <- gss %>%
  select(feelings_life, age, sex, region, pop_center, marital_status, total_children, own_rent, living_arrangement, hh_type, hh_size, self_rated_health, self_rated_mental_health, regilion_importance, language_knowledge, education, income_family, income_respondent)
data = na.omit(data)
```

# Plots 

## Validity

### Sex

```{r}
sex = as.data.frame(table(data$sex))
names(sex) = c('group', 'value')
sex <- sex %>% 
  arrange(desc(group)) %>%
  mutate(prop = value / sum(sex$value) *100)
sex %>%
  ggplot(aes(x='', y=value, fill=group))+
  geom_bar(width = 1, stat = "identity")+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(label = paste0(round(prop, 2), "%")), position = position_stack(vjust = 0.5), color = "black", size=1.5)
```

### Region

```{r}
region = data.frame(levels(as.factor(data$region)), as.data.frame(table(data$region))$Freq)
names(region) = c('group', 'value')
region <- region %>% 
  arrange(desc(group)) %>%
  mutate(prop = value / sum(value) *100)

theme_set(theme_classic())
region %>%
  ggplot(aes(x=reorder(group, -value), y=value))+
  geom_bar(width = 0.5, stat = "identity", fill = "tomato2")+
  labs(title = "Region", y = "responses", x ="Regions")+
  theme(axis.text.x = element_text(angle=65, vjust=0.6, size = 5))
```

### Age

```{r}
theme_set(theme_classic())
data %>%
  ggplot(aes(x=age)) +
  geom_histogram(binwidth=5)
```

## Relationship

```{r}
#par(mfrow = c(2,2))
data %>%
  ggplot(aes(y = feelings_life, x = age)) + 
  geom_point(size = 0.5)+
  geom_smooth(method="lm")+
  labs(title = "Age", y = "feelings of life", x ="Age")

data %>%
  ggplot(aes(y = feelings_life, x = hh_size)) + 
  geom_point(size = 0.5)+
  geom_smooth(method="lm")+
  labs(title = "House size", y = "feelings of life", x ="house size")

```

```{r}
feelings = data.frame(levels(as.factor(data$feelings_life)), as.data.frame(table(data$feelings_life))$Freq)
names(feelings) = c('group', 'value')
feelings <- feelings %>% 
  arrange(desc(group)) %>%
  mutate(prop = value / sum(value) *100)

theme_set(theme_classic())
feelings %>%
  ggplot(aes(x=reorder(group, as.numeric(group)), y=value))+
  geom_bar(width = 0.5, stat = "identity", fill = "tomato2")+
  labs(title = "Region", y = "responses", x ="Regions")+
  theme(axis.text.x = element_text(angle=65, vjust=0.6, size = 5))
```





```{r, warning=FALSE}
library(GGally)
data %>%
  select(feelings_life, age, total_children, hh_size,  self_rated_mental_health, education, income_family) %>%
  ggpairs(
    cardinality_threshold = 100, 
    colour = "Species", 
    lower = list(continuous = "points"), 
    axisLabels = "none",
    upper = list(continuous = "blank")
  )
```





